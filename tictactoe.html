<html>

<head>
    <title>Tic-Tac-Toe</title>
<!-- <script async src='/cdn-cgi/bm/cv/669835187/api.js'></script> -->
</head> 

<body>
    <div id = "sc"><h1>Score:</h1></h1></div>
    <table style="left: calc(50vw - 84px); position: absolute;">
        <tbody id="nigger">
            <tr>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td></td>
                <td></td>
                <td></td>
            </tr>
        </tbody>
    </table>
    <div><button id=reset>Reset</button></div>
    <div id="win_mes"></div>
    <script>
        const size = 3;
        let score = [0,0];
        let c = document.getElementById("nigger").children;
        let m = document.getElementById("win_mes");
        let s = document.getElementById("sc");
        let turn = 0;

        function buttonPressed(row, col) {
            console.log(`Button on row ${row} and col ${col} pressed`);
            setPlayed(row, col);
            let win = check_win();
            if (win == 1){
                console.log(`Player 1 Won!`);
                for (let i = 0; i < size; i++) {
                    for (let j = 0; j < size; j++) {
                        c[i].children[j].children[0].setAttribute("disabled", "");
                    }
                }
                let w = document.createElement("h1");
                w.innerHTML = "Player 1 Won";
                m.appendChild(w);
                score[0]++;
            }
            else if (win == 2){
                console.log(`Player 2 Won!`);
                for (let i = 0; i < size; i++) {
                    for (let j = 0; j < size; j++) {
                        c[i].children[j].children[0].setAttribute("disabled", "");
                    }
                }
                let w = document.createElement("h1");
                w.innerHTML = "Player 2 Won";
                m.appendChild(w);
                score[1]++;
            }
        }

        function setPlayed(row, col) {
            c[row].children[col].children[0].setAttribute("disabled", "");
            c[row].children[col].children[0].innerHTML = turn % 2 == 0 ? "X" : "O";
            /*
            if (turn % 2 == 0) vale X
            else vale O
            */
            turn++;
        }

        function check_win(){
            let win = 0;
            for (let i = 0; i < size; i++) {
                if (c[i].children[0].children[0].innerHTML == c[i].children[1].children[0].innerHTML && c[i].children[1].children[0].innerHTML == c[i].children[2].children[0].innerHTML){
                    if (c[i].children[0].children[0].innerHTML == "X"){
                        win = 1;
                        break;
                    }
                    else if (c[i].children[0].children[0].innerHTML == "O"){
                        win = 2;
                        break;
                    }
                }
                if (c[0].children[i].children[0].innerHTML == c[1].children[i].children[0].innerHTML && c[1].children[i].children[0].innerHTML == c[2].children[i].children[0].innerHTML){
                    if (c[0].children[i].children[0].innerHTML == "X"){
                        win = 1;
                        break;
                    }
                    else if (c[0].children[i].children[0].innerHTML == "O"){
                        win = 2;
                        break;
                    }
                }               
            }    
            if (c[0].children[0].children[0].innerHTML == c[1].children[1].children[0].innerHTML && c[1].children[1].children[0].innerHTML == c[2].children[2].children[0].innerHTML){
                if (c[0].children[0].children[0].innerHTML == "X"){
                    win = 1;
                }
                else if (c[0].children[0].children[0].innerHTML == "O"){
                    win = 2;
                }
            }
            else if (c[0].children[2].children[0].innerHTML == c[1].children[1].children[0].innerHTML && c[1].children[1].children[0].innerHTML == c[2].children[0].children[0].innerHTML){
                if (c[0].children[2].children[0].innerHTML == "X"){
                        win = 1;
                    }
                else if (c[0].children[2].children[0].innerHTML == "O"){
                    win = 2;
                }
            }
            return win;
        }
        function set_game(){
            for (let i = 0; i < size; i++) {
                for (let j = 0; j < size; j++) {
                    let el = document.createElement("button");
                    el.innerHTML = "?";
                    el.onclick = function (e) {
                        buttonPressed(i, j);
                    }
                    c[i].children[j].appendChild(el);
                }
            }
            let h = document.createElement("h3");
            h.innerHTML = "Player 1| "+score[0]+" | "+score[1]+" |Player 2 ";
            sc.appendChild(h);
        }
        function del_game(){
            for (let i = 0; i < size; i++) {
                for (let j = 0; j < size; j++) {
                    c[i].children[j].children[0].remove();
                }
            }
            m.children[0].remove();
            sc.children[1].remove();
        }
        
        let re = document.getElementById('reset');
        re.onclick = function(){
            del_game();
            set_game();
        }
        set_game();
    </script>
<script type="text/javascript">(function(){window['__CF$cv$params']={r:'6db63108df846f5f',m:'xBLmrpfkWy32tS852idvdnt8EBxlURONFWr35agRBQM-1644505064-0-ATbAASLLJGUB5Nlp+Inz3fdFwPD1c73p6BEKzsK5KJCfZHy3C9ndm31ffEWmgCvAsck2D4iKLkwCmk60/1ORc2UXMUz81/HT7kJ0KLe4KVuIbynhIb6I0uZ5wLtGkkLdIKEDsCaWEHFwGVR2jSOlRgDlCzCrLWjVGFQcRGlNjE5weu5deNPdMrLSzj8286VeoEDI+nHFkJ41la4NqJzbE/U=',s:[0x8e49a3939a,0x2c76e70693],}})();</script></body>

</html>